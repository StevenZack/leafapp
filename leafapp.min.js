function encodeInputsUrlEncoded(e){for(var t="",r=0;r<e.length;r++)if(e[r].multiple)for(var n=e[r].children,o=0;o<n.length;o++){var a=n[o];a.selected&&(t&&(t+="&"),t+=e[r].getAttribute("name")+"="+encodeURIComponent(a.value))}else("checkbox"!==e[r].type||e[r].checked)&&(t&&(t+="&"),t+=e[r].getAttribute("name")+"="+encodeURIComponent(e[r].value));return t}for(var vs=document.querySelectorAll("[page]"),i=0;i<vs.length;i++)vs[i].getAttribute("page")&&function(e){var t=new XMLHttpRequest;t.onreadystatechange=function(){4===t.readyState&&(t.status,e.outerHTML=t.responseText)},t.open("GET",e.getAttribute("page")),t.send()}(vs[i]);for(vs=document.querySelectorAll("button[href-delete]"),i=0;i<vs.length;i++){var v=vs[i];v.onclick=function(e){var t=e.currentTarget;if(confirm("Are you sure to delete?")){t.disabled=!0;var r=t.innerHTML;t.innerHTML='<progress style="width: 40px;"/>';var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState)return 200!==n.status?(alert(n.responseText),t.disabled=!1,void(t.innerHTML=r)):void(location.href=location.href)},n.open("DELETE",t.getAttribute("href-delete")),n.send()}}}for(vs=document.querySelectorAll("form[method]"),i=0;i<vs.length;i++){v=vs[i];var method=v.getAttribute("method").toLowerCase();method&&"get"!==method&&(v.onsubmit=function(e){e.preventDefault();var t=e.currentTarget,r=t.innerHTML,n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState)return 200!==n.status?(alert(n.responseText),t.disabled=!1,void(t.innerHTML=r)):void(n.responseText?location.href=n.responseText:location.href=location.href)};var o=t.getAttribute("method");o||(o="get"),o=o.toUpperCase();var a=t.getAttribute("enctype");a||(a="application/x-www-form-urlencoded");var i=null,s=t.getAttribute("action"),l=t.querySelectorAll("[name]");switch(a){case"application/x-www-form-urlencoded":i=encodeInputsUrlEncoded(l);break;case"multipart/form-data":i=new FormData;for(var d=0;d<l.length;d++){var u=l[d],c=u.value;u.files&&u.files.length>0&&(c=u.files),i.append(u.getAttribute("name"),c)}}t.disabled=!0,t.innerHTML='<progress style="width: 40px;"/>',n.open(o,s),n.setRequestHeader("Content-Type",a),n.send(i)})}